# Simplified Configuration for Geospatial Solutions Pipeline
# Auto-generates all derived paths, table names, and folder structure

# ============================================================================
# PROJECT SETTINGS
# ============================================================================
project:
  catalog: prp_mr_bdap_projects
  schema: geospatialsolutions
  volume_root: /Volumes/prp_mr_bdap_projects/geospatialsolutions/external/jrc/data

# ============================================================================
# COUNTRY SETTINGS
# ============================================================================
country:
  iso3: IND  # ISO 3166-1 alpha-3 country code

# ============================================================================
# INPUT FILES (User-provided paths)
# ============================================================================
inputs:
  # Proportions CSV (building type distribution by storey)
  proportions_csv: /Workspace/Users/npokkiri@munichre.com/inventory_nos_db/data/IND_NOS_storey_mapping_041125.csv

  # TSI (Total Sum Insured) multipliers CSV
  tsi_csv: /Volumes/prp_mr_bdap_projects/geospatialsolutions/external/jrc/data/inputs/multipliers/tsi.csv

  # Administrative boundaries (GeoPackage)
  admin_boundaries: /Volumes/prp_mr_bdap_projects/geospatialsolutions/external/jrc/data/inputs/admin/RMS_Admin0_geozones.gpkg

  # GHSL tile footprint (Shapefile)
  tile_footprint: /Volumes/prp_mr_bdap_projects/geospatialsolutions/external/jrc/data/inputs/tiles/GHSL2_0_MWD_L1_tile_schema_land.shp

# ============================================================================
# PROCESSING PARAMETERS
# ============================================================================
params:
  # Grid settings
  cell_size: 2000              # Grid cell size in meters
  export_crs: EPSG:4326        # Export coordinate reference system
  target_crs: ESRI:54009       # Target CRS for processing (Mollweide)

  # GHSL datasets to download
  datasets: built_c,smod       # Comma-separated: built_c (building), smod (settlement)

  # Download settings
  download_concurrency: 3      # Parallel download threads
  download_retries: 2          # Number of retry attempts

  # Raster processing
  use_smod: true               # Use SMOD (settlement model) data
  use_boundary_mask: true      # Apply country boundary mask
  include_nodata: true         # Include cells with no data
  add_percentages: false       # Add percentage columns to output

  # Performance tuning
  chunk_size: 10000            # Processing chunk size
  max_workers: 8               # Max parallel workers
  tile_parallelism: 4          # Tile processing parallelism
  sample_size: 10000           # Sample size for testing

  # Storage
  stage_to_local: true         # Stage tiles to local disk
  local_dir: /local_disk0/raster_cache
  spark_tmp_dir: /tmp/job3_grid_tmp

# ============================================================================
# OPERATIONAL FLAGS
# ============================================================================
flags:
  dry_run: false               # Set true for testing without actual writes
  preview: true                # Show preview of data
  preview_rows: 5              # Number of preview rows
  overwrite_schema: true       # Allow schema overwrite
  write_mode: overwrite        # Delta table write mode
  csv_infer_schema: true       # Infer CSV schema automatically
  save_temp_csv: false         # Save temporary CSV files
  save_per_tile: false         # Save results per tile
